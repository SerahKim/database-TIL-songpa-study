# ğŸ—“ï¸ 2025.05.23 (ê¸ˆ) â€“ êµìœ¡ ì¼ì§€

## ğŸ“š ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©

### MYBATIS
- MYBATIS 
  - Javaì—ì„œ SQLì„ XML ë˜ëŠ” Annotationìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” O/R Mapper í”„ë ˆì„ ì›Œí¬ 
    - ORM : ê°ì²´ ê´€ê³„ ë§¤í•‘, ë°ì´í„°ë² ì´ìŠ¤ì™€ ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ê°„ì˜ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ë°ì´í„°ë¥¼ ë³€í™˜í•´ì£¼ëŠ” í”„ë ˆì„ ì›Œí¬
  - DAO ê°ì²´ì™€ SQLë¬¸ì„ Mappingí•´ì£¼ëŠ” Persistence Frameworkì´ë‹¤.
    - Persistence : ì˜ì†ì„±, í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œë˜ë”ë¼ë„ ì‚¬ë¼ì§€ì§€ ì•ŠëŠ” ë°ì´í„°ì˜ ì„±ì§ˆ
  - JDBC vs MYBATIS
    
  | í•­ëª©            | JDBC          | MyBatis           |
      | ------------- | ------------- | ----------------- |
      | SQL ë¶„ë¦¬        | ê°€ëŠ¥í•˜ë‚˜ ê°•ì œ/ì§€ì› ì—†ìŒ | êµ¬ì¡°ì ìœ¼ë¡œ ë¶„ë¦¬ ì§€ì› (XML) |
      | íŒŒë¼ë¯¸í„° ì²˜ë¦¬       | ìˆ˜ë™ (index)    | ìë™ (ì´ë¦„ ê¸°ë°˜)        |
      | ê²°ê³¼ ë§¤í•‘         | ìˆ˜ë™            | ìë™/ë°˜ìë™            |
      | ì¬ì‚¬ìš©ì„±          | ì½”ë“œ ë³µë¶™ì´ ë§ìŒ     | Mapper ì¬ì‚¬ìš© ìš©ì´     |
      | ìƒì‚°ì„±           | ë‚®ìŒ            | ë†’ìŒ                |
      | ì˜¤ë¥˜ ë°œìƒ ì‹œ ìœ„ì¹˜ ì¶”ì  | ë³µì¡í•¨           | XMLì—ì„œ ë°”ë¡œ í™•ì¸ ê°€ëŠ¥    |

- MYBAITSë¥¼ í†µí•œ ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ í†µì‹  íë¦„
  - ![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FkFXjp%2Fbtrdes5ZgiP%2F7vb9L0T78i3A6anlaOsZq1%2Fimg.png)
    - Application : Controller í˜¸ì¶œ
    - Controller : Service í˜¸ì¶œ
    - Service : ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬, SqlSessionê°ì²´ë¥¼ ìƒì„±í•˜ê³  DAOë¥¼ í˜¸ì¶œí•˜ê³ , SqlSessionì„ ë‹«ì•„ì¤€ë‹¤.
    - DAO : MyBaitsì˜ SqlSession ë˜ëŠ” Mapper ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•´ì„œ SQL ì‹¤í–‰
      - SqlSessionì˜ CRUD ë©”ì†Œë“œ (Mapper API methods)
        - ë©”ì†Œë“œë¥¼ í†µí•´ JDBC API(JDBCì˜ Connection, Statement, PreparedStatement, Resultset ë“±)ì„ ê°„ì ‘ì ìœ¼ë¡œ í˜¸ì¶œí•œë‹¤.
        - `selectOne` : ë‹¨ì¼ ê²°ê³¼ ì¡°íšŒ (Read)
        - `selectList` : ë‹¤ì¤‘ ê²°ê³¼ ì¡°íšŒ, List ë°˜í™˜ (Read)
        - `selectMap` : ë‹¤ì¤‘ ê²°ê³¼ ì¡°íšŒ, Map ë°˜í™˜ (Read)
        - `Ã¬nsert` : ìƒˆ ë ˆì½”ë“œ ì‚½ì… (Create)
        - `update` : ê¸°ì¡´ ë ˆì½”ë“œ ìˆ˜ì • (Update)
        - `delete` : ê¸°ì¡´ ë ˆì½”ë“œ ì‚­ì œ (delete)
    - MyBaits ë‚´ë¶€ ì²˜ë¦¬ : ë‚´ë¶€ì ìœ¼ë¡œ DataSourceì™€ ì—°ê²°í•˜ê³  JDBC APIë¡œ DB ì ‘ê·¼
      - JDBCì˜ APIëŠ” SqlSessionì˜ CRUD ë©”ì†Œë“œë¥¼ í†µí•´ ì‹¤í–‰ëœë‹¤.
      - SqlSesstionê°ì²´ë¥¼ í†µí•´ DataSource(mybatis-config.xml)ë¡œë¶€í„° Connection íšë“
    - JDBC Driver : ì‹¤ì œ DBë¡œ SQL ì „ì†¡, ê²°ê³¼ ë°˜í™˜
- MYBATIS Component ë™ì‘ ê³¼ì •
  - ![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2F9ACBn%2FbtrdjQkgKvd%2Fyl8gcK7KEukWd89ZHX6JbK%2Fimg.png)
    1. MyBatis Config íŒŒì¼ì„ ì½ì–´ì˜´
        ```
       String resource = "xmlconfig/mybatis-config.xml";
       InputStream inputStream = Resources.getResourceAsStream(resource);
        ```
       - í˜„ì¬ ì‹¤ìŠµ ì½”ë“œ ì†ŒìŠ¤ì—ì„œëŠ” DataSourceëŠ” `resources/xmlconfig/mybatis-config.xml`ì— ê¸°ìˆ ë˜ì–´ ìˆë‹¤.
       - `mybatis-config.xml`ì—ëŠ” DB ì •ë³´, mapper íŒŒì¼ ê²½ë¡œ ë“±ì´ ë“¤ì–´ìˆë‹¤.
       - Template.java íŒŒì¼ì—ì„œ InputStreamì„ í†µí•´ Config íŒŒì¼ì„ ì½ì–´ì˜¤ê³  ìˆë‹¤.
    2. `SqlSesstionFactoryBuilder` ê°ì²´ë¥¼ ì´ìš©í•´ `SqlSessionFactory` ê°ì²´ë¥¼ ìƒì„±
        ```
        sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
        ```
       - `SqlSesstionFactoryBuilder` ê°ì²´ëŠ” ë‹¨ìˆœíˆ `SqlSessionFactory`ì„ ìƒì„±í•´ì£¼ê¸° ìœ„í•œ ìš©ë„
       - `SqlSessionFactory`ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ ì¡´ì¬í•´ì•¼ í•˜ë©°,ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆ ì—¬ëŸ¬ ì°¨ë¡€ SqlSessionFactoryë¥¼ ë‹¤ì‹œ ë¹Œë“œí•˜ì§€ ì•ŠëŠ” ê²ƒì´ ê°€ì¥ ì¢‹ì€ í˜•íƒœ
         (SqlSessionFactoryëŠ” ë¬´ê²ê³  ì„¤ì • ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œ í•œ ë²ˆë§Œ ë§Œë“¤ê³ , ì „ì—­ì ìœ¼ë¡œ ì¬ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì„±ëŠ¥ê³¼ ìì› ê´€ë¦¬ ì¸¡ë©´ì—ì„œ ê¶Œì¥ë˜ê¸° ë•Œë¬¸)
       - `SqlSessionFactory` ê°ì²´ì˜ `build()`ë©”ì†Œë“œë¥¼ í†µí•´ `sqlSessionFactory` ê°ì²´ ìƒì„±
    3. ì•± ì‹¤í–‰ ì¤‘(ëŸ°íƒ€ì„)ì— CRUD ì²˜ë¦¬ê°€ ë“¤ì–´ì˜¤ë©´ SqlSesstionFactoryë¡œ SqlSesstion ê°ì²´ ìƒì„±
       ```
       // default ê°’ : false
       // false : Auto Commit êº¼ì§(SQL ì‹¤í–‰ í›„ ì§ì ‘ Commit()ì„ í˜¸ì¶œí•´ì¤˜ì•¼ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜)
       // true : Auto Commit ì¼œì§ (SQLì„ ì‹¤í–‰í•˜ë©´ ì¦‰ì‹œ DBì— ë°˜ì˜)
       
       // getSqlSession()ì˜ ë¦¬í„´ê°’
       sqlSessionFactory.openSession(false);
       
       // Service ìª½ì—ì„œ getSqlSession ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ì—¬ SqlSession ê°ì²´ ìƒì„±
        SqlSession sqlSession = getSqlSession();
       ```
    4. SqlSession ê°ì²´ë¥¼ ì´ìš©í•´ DB ìš”ì²­ í›„ ê²°ê³¼ê°’ ë°˜í™˜(DAO ìª½ì—ì„œ ì‹¤í–‰)
       ```
       // selectOneì€ SqlSessionì— ë‚´ì¥ë˜ì–´ìˆëŠ” CRUD ë©”ì†Œë“œ
       // MenuMapper.selectMenuByCode : MenuMapper ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ selectMenuByCode ì•„ì´ë””ë¥¼ ê°€ì§„ SQLë¬¸ì„ ì½ì–´ì˜´.
       // codeë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬(ë™ì  ë°”ì¸ë”©ì´ ëœë‹¤.)
       
       return sqlSession.selectOne("MenuMapper.selectMenuByCode", code);
       ```
## ğŸ’» ì‹¤ìŠµ ì˜ˆì‹œ

### MYBATIS
- [Application](../../MYBATIS/chapter03_crud/src/main/java/com/xmlconfig/Application.java)
- [Controller](../../MYBATIS/chapter03_crud/src/main/java/com/xmlconfig/MenuController.java)
- [Service](../../MYBATIS/chapter03_crud/src/main/java/com/xmlconfig/MenuService.java)
- [DAO](../../MYBATIS/chapter03_crud/src/main/java/com/xmlconfig/MenuDAO.java)
- [Template.java : SqlSession ìƒì„± íŒŒì¼](../../MYBATIS/chapter03_crud/src/main/java/com/xmlconfig/Template.java)
- [mybatis-config.xml : DataSource](../../MYBATIS/chapter03_crud/src/main/resources/xmlconfig/mybatis-config.xml)
- [menu-mapper.xml : SQL íŒŒì¼](../../MYBATIS/chapter03_crud/src/main/resources/xmlconfig/menu-mapper.xml)

## âœï¸ ì˜¤ëŠ˜ì˜ íšŒê³ 
- ì˜¤ëŠ˜ì€ MyBatisì— ëŒ€í•´ ì „ë°˜ì ìœ¼ë¡œ ì´í•´í•  ìˆ˜ ìˆëŠ” ì‹œê°„ì´ì—ˆë‹¤. ì²˜ìŒì—” ë‹¨ìˆœíˆ "SQLì„ XMLë¡œ ë¶„ë¦¬í•´ì„œ ê´€ë¦¬í•˜ëŠ” í”„ë ˆì„ì›Œí¬"ë¼ê³ ë§Œ ì•Œê³  ìˆì—ˆëŠ”ë°, ì‹¤ì œë¡œ JDBCì™€ ë¹„êµí•˜ë©´ì„œ ì™œ ì‚¬ìš©í•˜ëŠ”ì§€, ì–´ë–¤ ì¥ì ì´ ìˆëŠ”ì§€ ëª…í™•íˆ ì²´ê°í•  ìˆ˜ ìˆì—ˆë‹¤.
- íŠ¹íˆ SqlSessionFactoryì™€ SqlSessionì˜ ìƒì„± ê³¼ì •, ê·¸ë¦¬ê³  mybatis-config.xmlì„ í†µí•´ ì„¤ì •ëœ DataSourceì—ì„œ Connectionì„ íšë“í•˜ëŠ” êµ¬ì¡°ë¥¼ ë°°ìš°ë©´ì„œ MyBatisê°€ ë‹¨ìˆœíˆ SQL Mapper ì—­í• ë§Œ í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼,
JDBC ì»¤ë„¥ì…˜ ì²˜ë¦¬ë„ íš¨ìœ¨ì ìœ¼ë¡œ ê°ì‹¸ì£¼ëŠ” êµ¬ì¡°ë¼ëŠ” ê±¸ ì•Œê²Œ ë˜ì—ˆë‹¤.